<!DOCTYPE html>
<html lang="zh-CN">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>红色问答全局过滤器</title>
   <style>
    html,body{
        width: 100%;
        height: 100%;
        display: flex;
        margin: 0;
        padding: 0;
    }
    button,textarea,body,select,input{
        background-color: #E1EBE7;
        font-family: fusion-pixel-12px-monospaced-zh_hant, serif;
    }
   </style>
   <script src="axios.js"></script>
   <script src="vue.js"></script>
   <script src="vue-quill.js"></script>
   <script src="quill-setup.js"></script>
   <link rel="stylesheet" href="vue-quill.snow.prod.css">
</head>

<body>
   
   <div id="app" style="padding:0.5em; border: 1px solid;margin: 0.2em;display: flex;flex-direction: column;flex-grow: 1;">
        <h1 style="text-align: center;color: red;">红色问答全局过滤器</h1>
        <div style="height: 0; flex-grow: 1;display: flex;flex-direction: column;flex-grow: 1;">
            <quill-editor id = "script_content"  ref="child" theme="snow" spellcheck = false style="flex-grow: 1; height: 0;"></quill-editor>
            <button style="height: 40px;font-size: medium;font-weight: bold;" @click="save_code()">保存</button>
        </div>
        </body>
   </div>
   <script>
    const { createApp } = Vue
    const app = createApp({
        data() {
            return {
            }
        },
        mounted () {
            axios
            .get("/get_gobal_filter_code")
            .then(
            res => {
                let code = res.data["data"]
                this.$refs.child.setText(code)
                // console.log(this.pkg_codes)
            })
            .catch(function (error) {
                console.log(error);
            });
        },
        methods: {
            save_code(){
                let content = this.$refs.child.getQuill().getText();
                let script = {
                    "data":content
                }
                axios
                .post("/set_gobal_filter_code",script)
                .then((res) => {
                    if(res.data['retcode'] == 0){
                        this.rename_pkg_process = []
                        alert("保存成功")
                    }else {
                        alert("保存失败")
                    }
                })
                .catch(function (error) {
                    console.log(error);
                    alert("保存失败")
                });
            },
        },
        mixins: [QuillMixin]
    })

    app.component('QuillEditor', VueQuill.QuillEditor);
    app.mount('#app')
   </script>
   
</body>

</html>
